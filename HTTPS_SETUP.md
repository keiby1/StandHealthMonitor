# Настройка HTTPS для StandHealthMonitor

## ✅ Сертификат уже создан!

Сертификат был успешно создан:
- **Файл keystore:** `certs/keystore.p12`
- **Экспортированный сертификат:** `certs/certificate.crt`
- **Пароль по умолчанию:** `changeit`

## Шаг 1: Импорт сертификата в браузер для доверия

Чтобы браузер доверял вашему сайту, нужно импортировать сертификат.

### Chrome/Edge (Windows) - Рекомендуемый способ

1. **Двойной клик** на файл `certs/certificate.crt`
2. Нажмите **"Установить сертификат"**
3. Выберите **"Текущий пользователь"** → **"Далее"**
4. Выберите **"Поместить все сертификаты в следующее хранилище"**
5. Нажмите **"Обзор"** → выберите **"Доверенные корневые центры сертификации"** → **"ОК"**
6. Нажмите **"Далее"** → **"Готово"**
7. Подтвердите установку → **"Да"**
8. **Перезапустите браузер**

После этого сайт `https://localhost:8443` будет отображаться как доверенный!

### Firefox

1. Откройте Firefox → **Настройки** → **Приватность и защита**
2. Прокрутите вниз до **"Сертификаты"** → нажмите **"Просмотр сертификатов"**
3. Вкладка **"Серверы"** → **"Импортировать"**
4. Выберите файл `certs/certificate.crt`
5. Отметьте **"Доверять этому CA для идентификации веб-сайтов"**
6. Нажмите **"ОК"**
7. **Перезапустите браузер**

### Альтернативный способ (для разработки)

Можно просто принять предупреждение браузера при первом посещении:
1. Откройте `https://localhost:8443`
2. Нажмите **"Дополнительно"** → **"Перейти на localhost (небезопасно)"**

⚠️ **Примечание:** При этом способе браузер будет показывать предупреждение каждый раз.

## Шаг 2: Запуск приложения

После генерации сертификата приложение будет доступно по адресу:
- **HTTPS:** `https://localhost:8443`

Приложение автоматически использует HTTPS при запуске.

## Шаг 3: Настройка пароля (опционально, для безопасности)

Если вы хотите использовать другой пароль для keystore, добавьте в `application-secret.properties`:

```properties
SSL_KEYSTORE_PASSWORD=ваш_безопасный_пароль
```

⚠️ **ВАЖНО:** Не забудьте изменить пароль в keystore:
```bash
keytool -storepasswd -keystore certs/keystore.p12 -storepass changeit -new ваш_новый_пароль
```

## Безопасность

⚠️ **ВАЖНО:**
- Самоподписанный сертификат подходит только для разработки
- Для продакшена используйте сертификат от доверенного CA (Let's Encrypt и т.д.)
- Не коммитьте `keystore.p12` в git (уже добавлен в .gitignore)
- Измените пароль по умолчанию `changeit` на более безопасный

## Устранение проблем

### Ошибка: "keystore.p12 not found"
- Убедитесь, что файл `certs/keystore.p12` существует
- Проверьте путь в `application.properties`: `file:./certs/keystore.p12`
- Путь должен быть относительно корня проекта (где находится `pom.xml`)

### Ошибка: "Wrong password"
- Проверьте пароль в `application.properties` или `application-secret.properties`
- По умолчанию пароль: `changeit`
- Если изменили пароль, обновите его в конфигурации

### Браузер показывает "Небезопасное соединение"
- Это нормально для самоподписанного сертификата
- Импортируйте сертификат в браузер (см. Шаг 1)
- После импорта сайт будет отображаться как доверенный

### Ошибка при запуске: "SSL configuration"
- Убедитесь, что файл `certs/keystore.p12` существует
- Проверьте правильность пути в `application.properties`
- Проверьте пароль keystore

## Регенерация сертификата

Если нужно пересоздать сертификат:

**Windows:**
```bash
./generate-ssl-cert.bat
```

**Linux/Mac/Git Bash:**
```bash
chmod +x generate-ssl-cert.sh
./generate-ssl-cert.sh
```

Или вручную:
```bash
keytool -genkeypair -alias standhealthmonitor -keyalg RSA -keysize 2048 -storetype PKCS12 -keystore certs/keystore.p12 -validity 365 -storepass changeit -keypass changeit -dname "CN=localhost, OU=Development, O=StandHealthMonitor, L=City, ST=State, C=RU" -ext "SAN=DNS:localhost,IP:127.0.0.1"
```

После регенерации нужно снова экспортировать сертификат:
```bash
keytool -exportcert -alias standhealthmonitor -keystore certs/keystore.p12 -storepass changeit -file certs/certificate.crt -storetype PKCS12
```

И снова импортировать его в браузер.

